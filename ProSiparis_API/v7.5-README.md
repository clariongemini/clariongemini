# ProSiparis API v7.5 - Yönetim Paneli (Faz 5: Sipariş Yönetimi)

Bu sürüm, ProSiparis Yönetim Paneli'ne platformun ticari ve operasyonel kalbi olan **Sipariş Yönetimi** modülünü ekler. Artık yöneticiler, müşteri siparişlerini baştan sona (yeni siparişten teslimata kadar) panel üzerinden takip edebilir ve yönetebilir. Bu, hem **Siparis-Servisi**'nde yeni backend endpoint'leri oluşturulmasını hem de bu endpoint'leri kullanan karmaşık bir frontend modülü geliştirilmesini içeren, kapsamlı bir "tam yığın" geliştirmedir.

## v7.5 Yenilikleri

- **Yeni Frontend Modülü: Sipariş Yönetimi:** Admin paneline, siparişleri listeleme, detaylarını görüntüleme, durumlarını güncelleme ve kargo bilgisi ekleme yeteneklerini sunan tam özellikli bir modül eklendi.
- **Yeni Backend Yetkisi: `siparis_yonet`:** Sipariş yönetimi işlemlerini güvence altına almak için **Auth-Servisi**'ne `siparis_yonet` adında yeni bir yetki eklendi.
- **Yeni Backend API'leri:** **Siparis-Servisi**, admin paneline hizmet vermek üzere, siparişleri listeleme, detaylandırma ve yönetme işlevleri sunan, `siparis_yonet` yetkisiyle korunan yeni bir `/api/admin/siparisler` endpoint seti ile güçlendirildi.
- **İnteraktif Arayüz:** Sipariş detay sayfası, yöneticinin sipariş durumunu bir modal pencere üzerinden kolayca değiştirmesine veya kargo bilgisi girmesine olanak tanıyan interaktif bileşenler içerir.

## Mimari Konseptler (v7.5 Güncellemeleri)

- **Okuma ve Yazma Sorumluluklarının Ayrılması:** Sipariş modülü, iki ana bileşenle "okuma" ve "yazma" sorumluluklarını ayırır:
    1.  `OrderListPage.jsx`: Çok sayıda siparişi verimli bir şekilde "okumak" ve özetlemek için `MUI DataGrid` kullanır.
    2.  `OrderDetailPage.jsx`: Tek bir siparişin tüm detaylarını "okumak" ve aynı zamanda `OrderStatusUpdateModal` gibi alt bileşenler aracılığıyla "yazma" (güncelleme) işlemlerini tetiklemek için kullanılır.
- **Olay Yönümlü Güncellemeler (Event-Driven):** Backend'de bir siparişin durumu güncellendiğinde veya kargoya verildiğinde, `SiparisService` ilgili olayı (`siparis.durum.guncellendi`, `siparis.kargolandi`) Event Bus'a yayınlar. Bu, `Bildirim-Servisi` gibi diğer servislerin bu değişikliklerden haberdar olup müşteriye e-posta göndermesi gibi işlemleri tetiklemesini sağlar.

## Servisler Arası İletişim Akışı

1.  **Admin UI (React)**, sipariş listesini getirmek için istek gönderir -> `GET /api/admin/siparisler`
2.  **Gateway-Servisi** isteği alır, JWT'yi doğrular ve `siparis_yonet` yetkisini kontrol eder.
3.  Yetki varsa, istek **Siparis-Servisi**'ne yönlendirilir.
4.  **Siparis-Servisi**, `listeleSiparisler` metodunu çalıştırır, veritabanından siparişleri alır ve yanıt olarak döner.
5.  Kullanıcı bir siparişin durumunu güncellediğinde, Admin UI -> `PUT /api/admin/siparisler/:id/durum` isteği gönderir ve bu istek yine aynı güvenlik katmanlarından geçerek Siparis-Servisi'nde işlenir.

## API Endpoint'leri (v7.5)

### Auth-Servisi (Güncelleme)
-   **Yeni Yetki:** `yetkiler` tablosuna `siparis_yonet` yetkisi eklendi.

### Siparis-Servisi (YENİ Endpoint'ler)
-   **`GET /api/admin/siparisler`**: Tüm siparişlerin özet bir listesini döner. (Yetki: `siparis_yonet`)
-   **`GET /api/admin/siparisler/:siparisId`**: Belirli bir siparişin tüm detaylarını (ürünler, adres vb.) döner. (Yetki: `siparis_yonet`)
-   **`PUT /api/admin/siparisler/:siparisId/durum`**: Bir siparişin durumunu günceller. (Yetki: `siparis_yonet`)
-   **`POST /api/admin/siparisler/:siparisId/kargo`**: Bir siparişe kargo bilgisi ekler ve durumunu "kargoya_verildi" olarak günceller. (Yetki: `siparis_yonet`)
